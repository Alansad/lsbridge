!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.lsbridge=t()}(this,function(){var e={};if(e.isLSAvailable=function(){var e="_";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(t){return!1}}(),e.isLSAvailable){var t=200,r=localStorage,o={},n=!1,i=function(){for(var e in o){var n=r.getItem(e);if(n){try{var a=JSON.parse(n);a&&(n=a)}catch(c){}for(var f=0;f<o[e].length;f++)o[e][f](n);r.removeItem(e)}}return setTimeout(i,t),!0};e.send=function(e,t){var o="";"function"==typeof t&&(t=t()),o="object"==typeof t?JSON.stringify(t):t,r.setItem(e,o)},e.subscribe=function(e,t){o[e]||(o[e]=[]),o[e].push(t),n||(n=i())}}else e.send=e.subscribe=function(){throw new Error("localStorage not supported.")};return e});